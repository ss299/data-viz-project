library(shiny)
library(dplyr)
library(tidyr)
library(ggplot2)
foodwaste_PPP <- read.csv("~/Desktop/info201finaldata.csv")
# Define server logic required to draw a histogram
shinyServer(function(input, output) {
output_scatter_plot <- reactive({
foodwaste_PPP %>% filter(X.1 == input$pick_income)
})
output$scatterPlot <- renderPlot({
ggplot(output_scatter_plot(),aes(food.waste, PPP.capita)) + geom_point() + scale_y_log10() +geom_smooth(method = lm, se = FALSE) + labs(title = "Food Waste VS PPP Capita", x = "Food Waste", y = "PPP capita") + theme(plot.title = element_text(color = "black", size = 20, face = "bold", hjust = 0.5))
})
output_comparison <- reactive({
foodwaste_PPP %>% filter(Country.Name %in% input$select_country) %>%
select(Country.Name, pick = input$select_columns)
})
output$compare_plot <- renderPlot({
ggplot(output_comparison(), aes(Country.Name)) + geom_col(aes(y = pick),
fill = "skyblue") +
scale_fill_hue(c=45, l=80) +
labs(title = paste("A graph to compare the countries",input$select_columns),
y = input$select_columns) +
theme_classic() +
theme(plot.title = element_text(color = "black", size = 20,
face = "bold", hjust = 0.5))
})
}
library(shiny)
library(dplyr)
library(tidyr)
library(ggplot2)
foodwaste_PPP <- read.csv("~/Desktop/info201finaldata.csv")
# Define UI for application that draws a histogram
shinyUI(fluidPage(
# Application title
titlePanel("To what extent does purchase power impact the consumption and wastage of food?"),
# Sidebar with a slider input for number of bins
sidebarLayout(
sidebarPanel(
radioButtons("pick_income", label = h3("Pick a income level"), choices = list("High Income" = "HIC", "Upper Medium Income" = "UMC", "Lower Medium income" = "LMC", "Lower Income" = "LIC")),
selectInput("select_columns",
label = h3("Compare PPP per Capita or Food Waste"),
list("Food Waste" = "food.waste",
"PPP per capita" = "PPP.capita")),
selectInput("select_country", label = h3("Pick a country"),
choices = unique(foodwaste_PPP$Country.Name), multiple = TRUE)
),
# Show a plot of the generated distribution
mainPanel(
tabsetPanel(
tabPanel("Food Waste VS PPP capita",plotOutput("scatterPlot")),
tabPanel("Food Waste VS PPP capita Comparison", plotOutput("compare_plot"))
)
)
)
))
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
